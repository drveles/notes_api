# API для заметок
**RESTfull cервис для управления заметками.** <br>

- Пользователи имеют доступ только к своим заметкам <br>
- Заметки проверярются на орфографические ошибки используя API сервиса "Яндекс.Спеллер" <br>

Stack: `Python`, `MongoDB`, `Docker`, `FastAPI`, `aiohttp`, `asyncio`, `unittest`, `requests` <br>


## API - `FastAPI`

### Endpoints:

#### 1. POST `http://host:port/add-note/`<br>
**Добавление новой заметки пользователя в базу данных.**<br>
Обязательное тело запроса:
```json
{
    "note": "Note text",
    "have_typo": False,
    "username": "user1",
    "sha_password": "user1_sha_password",
}
```
В ответе возвращается JSON с информацией.<br>

#### 2. GET `http://host:port/notes/`<br>
**Возврат всех заметок пользователя.**<br>
Обязательные параметры:<br>

```json
{
    "username": "user1", 
    "sha_password": "user1_sha_pass"
}
```
В ответе возвращается JSON с заметками.<br>


## DB - `MongoDB` <br>
Считаю, что для текстовых заметок документоориентированная база данных подходходит идеально.<br>
Заметки хранятся в JSON формате, со следующими полями:
``` json 
{
    "_id": auto
    "username": "str"
    "note": "str" 
    "have_typo": bool
}
```

## Тестирование

### Автотесты
1. Поднимаем докер контейнеры с сервисом и базой данных:<br>
`docker compose up --build -d`<br>
2. Устнавливаем зависимости для тестов:<br>
`pip install requests aiohttp`<br>
3. Запускаем тесты:<br>
`python3 tests.py`<br>

### Ручное 
1. Поднимаем докер контейнеры, если они еще не работают<br>
`docker compose up --build -d`<br>
2. Открываем в браузере [http://0.0.0.0:8000/docs](http://0.0.0.0:8000/docs)
3. Заполняем данные для запросов. Примеры данных пользователей: 
```json
{
    {
        "username": "user1",
        "sha_password": "0a041b9462caa4a31bac3567e0b6e6fd9100787db2ab433d96f6d178cabfce90",
    },
    {
        "username": "user2", 
        "sha_password": "6025d18fe48abd45168528f18a82e265dd98d421a7084aa09f61b341703901a3",
    },
}
```

## Что реализовано:
- Аутентификация пользователей, не храня сами пароли, а только их sha256
- Авторизация пользователей, чтобы каждый видел только свои заметки
- API для обработки запросов пользователей
    - **Добавление и просмотр заметок**
    - Валидация текста на ошибки через Яндекс.Спеллер
    - Сохранение заметок в базу данных
- Оркестация docker контейнерами с компонентами сервиса
- Тесты для всех компонентов. Модульные и интеграционные
- Код соответствует стилевым нормам. Black + Pylint
- В коде прописаны подсказки типов
- Описана инструкция по тестированию API

## Что не сделано:
- Терминальный интерфейс для работы с заметками.
- Тесты в docker контейнере, с сохранением логов теста.